# K-V Software Performance Comparison

## Synopsis
A paper that compares various k-v storage software performance. From "Research
Problem Lists.docx": "Measure the performance of k-v storage software, e.g.,
Redis, vs. SQL database?".

The idea behind this is to try to treat several of these storage structures as
the same, and then push incrementally more data to them and measure
performance. Performance here can be more than time, but also I/O writes and
reads.

## Format
A C program named `gen_input` is used to generate random, shuffled, unique keys
for each of the database programs to read in and insert into their respective
databases.

All executables are made in a way to where they print the following format
string (or some other similar variant):
```
Inserted ??? keys in ???ms
```

This allows us to easily grab runtimes without any kind of shell scripting
magic. It also allows us to time exactly a specific portion of each program
without overhead of other parts affecting it.

## What's planned
### Database Storage Systems
| | SQL | Radis | ??? |
| ---: | :---: | :---: | :---: |
| Node.js - Single Query | ✅ | ✅ | ❓ |
| Node.js - Multi-Query | ❌ | ❌ | ❓ |
| Command Line - Single Query | ✅ | ✅ | ❓ |
| Command Line - Multi-Query | ❌ | ❌ | ❓ |

#### Notes
* ***Single Query** refers to inserting all keys in a single query. **Multi-Query** refers to inserting one key per query.*
* *Each test has two variants: **Node.js**, being a widely used server-side Javascript interface, as well as the **Command Line** applications compiled in C and distributed via official Arch-Linux repositories. Performance between the two is measured for a potential speed advantage one may have over another.*

### Tests Completed
| | SQL | Radis | ??? |
| ---: | :---: | :---: | :---: |
| HDD | ✅ | ✅ | ❓ |
| SSD | ✅ | ✅ | ❓ |

### Procedure
#### Todo
```diff
+ Incremental Data Generation (To chuck at each program)
- csv2graph (Optional. Could just use Excel).
```

## How does this work?
There are several various programs in this project. Which are required to run
properly.

### 1. gen\_input
First, let's introduce `gen_input` in the `c` directory. This program has the
following syntax:
```bash
UNIX> ./gen_input amount seed
```

It will generate unique key-value pairs based on the amount specified in the
arguments (namely **amount**). In all scripts we use, the seed will always be
**0**. The other programs will use this to insert keys accordingly into the
database software.

#### Example
```bash
UNIX> ./gen_input 10 0
7 3
14 6
48 2
45 0
38 3
28 5
3 0
58 5
22 1
32 2
```

The keys are generated in order, and then are shuffled via the **Fisher-Yates**
shuffling algorithm. We don't need a specific shuffle, so a simple algorithm
like this will suffice to ensure that keys aren't put in order.

### 2. Node.JS files (mysql & redis main.js)
The `mysql` and `redis` directories both feature a `main.js` file which is used
to execute key insertion. They both are consistent, and conform to the
following argument list:
```bash
UNIX> node main.js input_file
```

The **input_file** is simply a file that was generated by **gen_input**. See
how this all comes together?

#### 2.1. MySQL requirements & setup
MySQL requires setting up a localhost mysql service (On Arch Linux, this is
known as **mysqld**). It must also conform to the following:
* There must be a user named **cs560_usr**, with the hostname of **localhost**, and must have a password of **yes**. It must have **ALL** permissions granted.
* There must be a database called **cs560_test**, along with a table named **test** in it. This table must have 2 columns:
  * **t_key** - A **BIGINT** that is also a **Primary Key**. This is for storing the key.
  * **t_value** - A **BIGINT** (Well, it can be an **INT** as well). This is for storing the value.

The `mysql/main.js` will attempt to connect to the required user at a mysql
database specified at **localhost**. If it is unable to do so, you're in for a
bad day.

#### 2.2. Redis requirements & setup
Redis has much more lenient requirements. Assuming the user has the `redis`
package installed on a Linux machine, Redis can be interacted with by simply
starting up the Redis server via:
```bash
UNIX> redis-server
```

Afterwards, you are able to interact with Redis on any client locally. You can
test this by running `redis-cli` via:
```bash
UNIX> redis-cli
```

You should start `redis-server` in a seperate terminal session, as it should
run in the background.
